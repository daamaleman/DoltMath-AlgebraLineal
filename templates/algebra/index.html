{% extends "algebra/base.html" %} 
{% block content %}

<!-- Hero principal -->
<section
  class="relative overflow-hidden rounded-2xl mt-6 bg-gradient-to-br from-brand-700 via-brand-600 to-ember-500 text-white shadow-xl"
>
  <div
    class="absolute inset-0 opacity-15 pointer-events-none"
    aria-hidden="true"
  >
    <svg class="w-full h-full" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <pattern id="grid" width="28" height="28" patternUnits="userSpaceOnUse">
          <path d="M28 0H0v28" fill="none" stroke="white" stroke-opacity=".3" />
        </pattern>
      </defs>
      <rect width="100%" height="100%" fill="url(#grid)" />
    </svg>
  </div>
  <div
    class="relative max-w-6xl mx-auto px-8 py-12 grid md:grid-cols-1 gap-8 items-center"
  >
    <div>
      <h2 class="text-3xl md:text-4xl font-extrabold tracking-tight">
        DoltMath — Álgebra Lineal, simple y exacta
      </h2>
      <p class="mt-3 text-white/90">
        Opera con enteros, fracciones como
        <code class="px-1 py-0.5 bg-white/20 rounded">3/4</code> y decimales sin
        perder precisión. Matrices claras, pasos legibles y resultados
        confiables.
      </p>
      <div class="mt-6 flex flex-wrap gap-3">
        <a
          href="{% url 'suma' %}"
          class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white text-brand-700 font-semibold shadow hover:shadow-md"
        >
          <span>Empezar ahora</span>
          <svg
            width="18"
            height="18"
            viewBox="0 0 24 24"
            fill="none"
            class="opacity-90"
          >
            <path
              d="M5 12h14M13 5l7 7-7 7"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </a>
        <button
          id="btnShowFormats"
          type="button"
          class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/10 border border-white/20 hover:bg-white/15"
        >
          Formatos válidos
        </button>
      </div>
    </div>
  </div>
  <div class="relative border-t border-white/10">
    <div
      class="max-w-6xl mx-auto px-6 py-4 grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm justify-center"
      style="margin-left:auto; margin-right:auto;"
    >
      <div class="flex items-center gap-2 justify-center">
      <span class="w-2 h-2 rounded-full bg-amber-300"></span> Operaciones precisas con
      fracciones
      </div>
      <div class="flex items-center gap-2 justify-center">
      <span class="w-2 h-2 rounded-full bg-amber-300"></span> Modo oscuro
      </div>
      <div class="flex items-center gap-2 justify-center">
      <span class="w-2 h-2 rounded-full bg-amber-300"></span> Teclado flotante
      </div>
    </div>
  </div>
</section>

<!-- Acciones rápidas -->
<section class="mt-8">
  <div class="grid md:grid-cols-4 gap-4">
    <a
      href="{% url 'suma' %}"
      class="group rounded-xl border border-slate-200 bg-white p-4 shadow hover:shadow-md transition"
    >
      <div class="flex items-center gap-3">
        <div
          class="w-10 h-10 rounded-lg bg-brand-50 text-brand-700 flex items-center justify-center font-bold"
        >
          +
        </div>
        <div>
          <div class="font-semibold">Suma</div>
          <div class="text-slate-500 text-sm">A + B</div>
        </div>
      </div>
    </a>
    <a
      href="{% url 'multiplicacion' %}"
      class="group rounded-xl border border-slate-200 bg-white p-4 shadow hover:shadow-md transition"
    >
      <div class="flex items-center gap-3">
        <div
          class="w-10 h-10 rounded-lg bg-brand-50 text-brand-700 flex items-center justify-center font-bold"
        >
          ×
        </div>
        <div>
          <div class="font-semibold">Multiplicación</div>
          <div class="text-slate-500 text-sm">A · B</div>
        </div>
      </div>
    </a>
    <a
      href="{% url 'gauss' %}"
      class="group rounded-xl border border-slate-200 bg-white p-4 shadow hover:shadow-md transition"
    >
      <div class="flex items-center gap-3">
        <div
          class="w-10 h-10 rounded-lg bg-ember-50 text-ember-700 flex items-center justify-center font-bold"
        >
          E
        </div>
        <div>
          <div class="font-semibold">Matriz escalonada</div>
          <div class="text-slate-500 text-sm">A|b → escalonada</div>
        </div>
      </div>
    </a>
    <a
      href="{% url 'gauss_jordan' %}"
      class="group rounded-xl border border-slate-200 bg-white p-4 shadow hover:shadow-md transition"
    >
      <div class="flex items-center gap-3">
        <div
          class="w-10 h-10 rounded-lg bg-ember-50 text-ember-700 flex items-center justify-center font-bold"
        >
          GJ
        </div>
        <div>
          <div class="font-semibold">Gauss‑Jordan</div>
          <div class="text-slate-500 text-sm">A|b → reducida</div>
        </div>
      </div>
    </a>
  </div>
</section>

<!-- Cómo funciona -->
<section class="mt-10">
  <h3 class="text-xl font-bold">Cómo funciona</h3>
  <ol class="mt-4 grid md:grid-cols-3 gap-4">
    <li class="rounded-xl border border-slate-200 bg-white p-4 shadow">
      <div class="font-semibold mb-1">1. Elige la operación</div>
      <div class="text-slate-600 text-sm">
        Suma, Multiplicación, Gauss o Gauss‑Jordan.
      </div>
    </li>
    <li class="rounded-xl border border-slate-200 bg-white p-4 shadow">
      <div class="font-semibold mb-1">2. Genera la matriz</div>
      <div class="text-slate-600 text-sm">
        Define filas y columnas y escribe valores como 3/4 o 1.25.
      </div>
    </li>
    <li class="rounded-xl border border-slate-200 bg-white p-4 shadow">
      <div class="font-semibold mb-1">3. Calcula y copia</div>
      <div class="text-slate-600 text-sm">
        Obtén el resultado y copia la matriz con un clic.
      </div>
    </li>
  </ol>
</section>

<!-- Consejos y ejemplos -->
<section class="mt-10 rounded-2xl border border-slate-200 bg-white p-6 shadow">
  <div class="flex flex-wrap items-center justify-between gap-4">
    <div>
      <h3 class="text-lg font-bold">Ejemplos rápidos</h3>
      <p class="text-slate-600 text-sm">
        Copia un ejemplo a tu portapapeles para pegarlo en la herramienta
        correspondiente.
      </p>
    </div>
    <div class="flex flex-wrap gap-3">
      <button
        id="copyExampleSum"
        type="button"
        class="px-4 py-2 rounded-full bg-brand-600 text-white font-semibold hover:brightness-105"
      >
        Copiar ejemplo de Suma
      </button>
      <button
        id="copyExampleGauss"
        type="button"
        class="px-4 py-2 rounded-full bg-brand-500 text-white border-slate-200 font-semibold hover:brightness-110"
      >
        Copiar ejemplo A|b
      </button>
    </div>
  </div>
</section>

<!-- Recientes (se muestra si hay historial) -->
<section
  id="recentSection"
  class="mt-10 hidden rounded-2xl border border-slate-200 bg-white p-6 shadow"
>
  <div class="flex items-center justify-between gap-4">
    <h3 class="text-lg font-bold m-0">Recientes</h3>
    <button id="clearRecentsHome" class="text-red-600 hover:underline text-sm">
      Limpiar historial
    </button>
  </div>
  <div
    id="recentOps"
    class="mt-4 grid sm:grid-cols-2 md:grid-cols-3 gap-4"
  ></div>
</section>

<script>
  // SweetAlert helpers
  const toast = (icon, title) => {
    if (window.Swal) {
      Swal.fire({
        toast: true,
        position: "top-end",
        timer: 1400,
        showConfirmButton: false,
        icon,
        title,
      });
    }
  };
  // Formatos válidos
  document.getElementById("btnShowFormats")?.addEventListener("click", () => {
    if (window.Swal) {
      Swal.fire({
        icon: "info",
        title: "Formatos válidos",
        html: `
            <div style="text-align:left">
              <ul style="margin:0; padding-left:18px;">
                <li>Enteros: <code>7</code>, <code>-2</code></li>
                <li>Fracciones: <code>3/5</code>, <code>-4/7</code></li>
                <li>Decimales: <code>1.25</code>, <code>-0.5</code></li>
              </ul>
            </div>`,
        confirmButtonText: "Entendido",
        confirmButtonColor: "#dc2626",
      });
    }
  });
  // Copiar ejemplos
  document
    .getElementById("copyExampleMul")
    ?.addEventListener("click", async () => {
      const A = `1 2\n3 4`;
      const B = `5 6\n7 8`;
      const text = `A =\n${A}\n\nB =\n${B}`;
      try {
        await navigator.clipboard.writeText(text);
        toast("success", "Ejemplo copiado");
      } catch {
        toast("error", "No se pudo copiar");
      }
    });
  document
    .getElementById("copyExampleSum")
    ?.addEventListener("click", async () => {
      const A = `1 2\n3 4`;
      const B = `5 6\n7 8`;
      const text = `A =\n${A}\n\nB =\n${B}`;
      try {
        await navigator.clipboard.writeText(text);
        toast("success", "Ejemplo de suma copiado");
      } catch {
        toast("error", "No se pudo copiar");
      }
    });
  document
    .getElementById("copyExampleGauss")
    ?.addEventListener("click", async () => {
      const aug = `1 2 | 5\n3 4 | 11`;
      try {
        await navigator.clipboard.writeText(aug);
        toast("success", "Ejemplo A|b copiado");
      } catch {
        toast("error", "No se pudo copiar");
      }
    });

  // Render de recientes en la Home
  (function () {
    const wrap = document.getElementById("recentOps");
    const section = document.getElementById("recentSection");
    const clearBtn = document.getElementById("clearRecentsHome");
    if (!wrap) return;
    try {
      const data = JSON.parse(localStorage.getItem("recentOps") || "[]");
      if (!Array.isArray(data) || data.length === 0) {
        section?.classList.add("hidden");
        return;
      }
      section?.classList.remove("hidden");
      const fmtDate = (ts) => new Date(ts).toLocaleString();
      wrap.innerHTML = data
        .slice(0, 6)
        .map((x) => {
          const label = x.opLabel || x.op || "Operación";
          return `
            <a href="${
              x.path
            }" class="block rounded-xl border border-slate-200 bg-white p-4 shadow hover:shadow-md">
              <div class="text-sm text-slate-500">${fmtDate(x.ts)}</div>
              <div class="mt-1 font-semibold">${label}</div>
              <div class="text-slate-500 text-sm truncate">${
                x.title || ""
              }</div>
            </a>`;
        })
        .join("");
      clearBtn?.addEventListener("click", () => {
        try {
          localStorage.removeItem("recentOps");
        } catch {}
        section.classList.add("hidden");
        if (window.Swal) {
          Swal.fire({
            toast: true,
            position: "top-end",
            timer: 1200,
            showConfirmButton: false,
            icon: "success",
            title: "Historial limpiado",
          });
        }
      });
    } catch {}
  })();
</script>

{% endblock %}
